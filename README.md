# AI 강사 Agent v2.0: PPT 강의 영상 자동 제작 시스템

## 프로젝트 개요

이 프로젝트는 **Generative AI (LLM & TTS)와 LangGraph**를 활용하여 PPT(PowerPoint) 자료를 입력받아 **끊김 없는 연속적인 강의 스크립트**를 생성하고, 최종적으로 **MP4 형식의 강의 영상**까지 자동으로 제작하는 End-to-End 멀티모달 Agent 시스템입니다.

기존의 수동적인 스크립트 작성, 녹화, 편집 과정에서 발생하는 비효율을 해소하고, 교육/보고 자료 제작의 **즉시성**과 **전달 품질의 표준화**를 목표로 구축되었습니다.

### 핵심 가치 및 목표

| 구분 | 내용 |
| :--- | :--- |
| **문제 해결** | PPT 자료를 기반으로 매번 수동으로 작성/녹화해야 했던 강의 콘텐츠 제작의 비효율 해소. |
| **핵심 가치** | **1. 강의 연속성 확보:** LLM이 문맥을 인지하여 자연스럽게 연결되는 스크립트 자동 생성. |
| | **2. End-to-End 자동화:** PPT 분석부터 최종 MP4 영상 병합까지 사람 개입 최소화. |
| **주요 기술** | **멀티모달 통합, LangGraph 워크플로우 오케스트레이션, 프롬프트 엔지니어링.** |

---

## 기술 스택 (Technology Stack)

| 구분 | 기술 스택 | 목적 및 역할 |
| :--- | :--- | :--- |
| **Orchestration** | `LangGraph` | 복잡한 멀티-스텝 프로세스(반복/분기)를 관리하는 상태 기반 워크플로우 구축. |
| **Generative AI** | `OpenAI GPT-4o` (LLM), `OpenAI TTS` | 강의 내용 생성, 스크립트 작성, **강의 흐름 제어**, 음성 변환. |
| **Tool/Data** | `python-pptx`, `SerpAPI` | PPT 파일 분석 및 슬라이드별 텍스트/이미지 추출, 외부 정보 검색 및 부연 설명 추가. |
| **Media Processing** | `FFmpeg` | 슬라이드 이미지와 TTS 음성 파일을 결합하여 슬라이드별 MP4 생성 및 최종 영상 병합. |
| **Frontend** | `Gradio` | 사용자 편의를 위한 웹 인터페이스 구축 (PPT 업로드, 톤/Voice 선택, 결과 확인). |

---

## ⚙️ Agent 아키텍처 및 Flow

LangGraph를 활용한 Agent의 워크플로우는 **'초기 준비', '반복 루프', '최종 마무리'**의 3단계로 구성됩니다.

| 영역 | 노드 (Node) | 역할 |
| :--- | :--- | :--- |
| **초기 준비** | `Parse_all` | PPTX 파일 분석, 슬라이드별 텍스트/이미지/제목 분해 및 추출. |
| **반복 루프** | `Tool_search` | 슬라이드 제목 기반 외부 검색 (부연 설명 자료 확보). |
| | `Gen_page` | PPT 내용과 검색 결과를 결합하여 페이지 설명 내용 생성. |
| | **`Gen_script_ctx`** | 이전 스크립트와 다음 슬라이드 제목을 참조하여 **연속성 있는 강의 스크립트** 생성. |
| | `tts` | 생성된 스크립트를 TTS Voice(Alloy 등)로 음성 파일 변환. |
| | `Make_video` | 슬라이드 스냅샷과 음성 파일을 결합하여 슬라이드별 MP4 제작. |
| **마무리** | `Acc_step` (Router) | 다음 슬라이드 유무에 따라 **반복(CONTINUE)** 또는 **종료(DONE)** 분기. |
| | `concat` | 모든 슬라이드 영상을 하나의 최종 강의 영상으로 병합. |
| | `Make_quiz` | 강의 내용을 기반으로 퀴즈 생성 (선택적). |

---

## ✨ 핵심 기여 및 고도화 파트: 강의 스크립트 생성 (Gen\_script\_ctx)

저는 이 프로젝트에서 **'강의의 연속성'을 확보하는 스크립트 생성 모듈**을 담당했으며, LLM의 한계를 극복하기 위한 **프롬프트 엔지니어링**을 적용했습니다.

### 1. 문제 정의 (Before)

*   초기 LLM 스크립트: 각 슬라이드를 독립적인 단위로 인식하여, 슬라이드 전환 시마다 **"감사합니다.", "오늘 발표를 시작하겠습니다."** 등 불필요한 인사말이 반복되어 강의 흐름이 끊기는 문제 발생.

### 2. 해결 전략 (After)

**"하나의 연속적인 강의 영상"** 제작을 목표로 시스템에 다음 3가지 핵심 규칙을 주입하여 LLM을 성공적으로 오케스트레이션 했습니다.

| 규칙 | 프롬프트 지침 | 기여 내용 |
| :--- | :--- | :--- |
| **연속성 보장** | "직전 스크립트의 마지막 문장에서 **완벽하게 연결**되도록 현재 슬라이드의 설명을 **바로 시작**할 것." | LLM의 문맥 인지 능력을 극대화하여 문장 간의 **흐름 단절을 봉쇄**했습니다. |
| **흐름 제어** | "스크립트 마지막에 **다음 슬라이드 제목**을 활용하여 청중의 기대감을 높이는 예고 멘트를 포함할 것." | 다음 슬라이드가 **새로운 주제**라도 자연스럽게 다리를 놓는 강사 역할을 LLM이 수행하도록 유도했습니다. |
| **금지 규칙** | "('안녕하세요', '오늘', '감사합니다' 등) **연속성을 저해하는 표현은 절대 사용하지 않을 것** (단, 최종 슬라이드 끝인사만 허용)." | 불필요한 군더더기 표현을 시스템적으로 차단하여 스크립트의 품질을 표준화했습니다. |

---

## 💻 실행 및 결과 시연

### 1. 웹 데모 (Gradio)
<img width="1272" height="851" alt="image" src="https://github.com/user-attachments/assets/4b351cb6-26a4-4902-bc6e-95f7f9fbe132" />
...

### 2. 최종 결과물 (MP4)

//

---

## 🔮 기대 효과

*   **즉시성:** 신제품/보고 자료 업데이트 즉시, 교육 영상으로 변환하여 배포 가능.
*   **표준화:** LLM이 제어하는 일관된 톤과 흐름으로 **전달 품질 균일화**.
*   **효율성:** 발표 준비 시간 (특히 스크립트 작성 및 녹음)을 획기적으로 단축하여 **고객사 담당자**의 업무 효율 증대.
